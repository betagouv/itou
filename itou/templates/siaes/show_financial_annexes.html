{% extends "layout/content.html" %}
{% load i18n %}

{% block title %}{% translate "Mes annexes financières" %}{{ block.super }}{% endblock %}

{% block messages %}
    {{ block.super }}

    {% if current_siae.is_active %}
        <div class="alert alert-success" role="alert">
            {% translate "Votre structure est active car elle est associée à au moins une annexe financière valide listée ci-dessous ou bien elle a été manuellement activée par notre support. Vous n'avez rien à faire." %}
        </div>
    {% elif current_siae_is_asp %}
        <div class="alert alert-danger" role="alert">
            {# Inactive siaes of ASP source cannot be fixed by user. #}
            {% translate "Votre structure est inactive car elle n'est associée à aucune annexe financière valide. Contactez nous : " %}
            {{ ITOU_EMAIL_ASSISTANCE }}
        </div>
    {% elif current_siae_is_user_created %}
        <div class="alert alert-danger" role="alert">
            {# Inactive user created siaes can be fixed by the user. #}
            {% translate "Votre structure sera prochainement désactivée car elle n'est associée à aucune annexe financière valide. Veuillez dès que possible procéder à la sélection d'une annexe financière valide ci-dessous." %}
        </div>
    {% endif %}

{% endblock %}

{% block content %}

<div class="d-sm-inline-flex mb-3 align-items-sm-baseline">
    <h1>{% translate "Mes annexes financières" %}</h1>
    <h2 class="text-muted ml-sm-4">{{ siae.display_name }}</h2>
</div>

<div class="table-responsive">
    <table class="table table-striped table-bordered">
        <thead>
            <tr>
                <th scope="col">{% translate "Numéro d'annexe financière" %}</th>
                <th scope="col">{% translate "Validité à ce jour" %}</th>
            </tr>
        </thead>
        <tbody>
            {% if financial_annexes %}
                {% for financial_annex in financial_annexes %}
                    <tr>
                        <td>{{ financial_annex.number }}</td>
                        {% if financial_annex.is_active %}
                            <td><span class="badge badge-success">Valide</span></td>
                        {% else %}
                            <td><span class="badge badge-danger">Invalide</span></td>
                        {% endif %}
                    </tr>
                {% endfor %}
            {% else %}
                <tr>
                    <td>Aucune annexe financière associée à cette structure.</td>
                    <td></td>
                </tr>
            {% endif %}
        </tbody>
    </table>
</div>

{% if can_select_af %}
    <a href="{% url 'siaes_views:select_financial_annex' %}" class="align-self-center">
        <button class="btn btn-primary mb-1 w-100 w-sm-auto mt-2">{% translate "Sélectionner une autre annexe financière" %}</button>
    </a>
{% endif %}

{% endblock %}
